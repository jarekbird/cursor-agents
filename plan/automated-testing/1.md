# TASK-001: Verify existing test commands

**Section**: 0. Baseline & Tooling
**Subsection**: 0.1
**Task ID**: TASK-001

## Description

Verify that the `package.json` file contains the necessary test scripts for running Jest tests. This task ensures the test infrastructure is properly configured before proceeding with test development. If any scripts are missing, they should be added to maintain consistency with standard Jest testing practices.

**Reference Implementation**: `virtual-assistant/cursor-agents/package.json` (lines 7-23)

## Current State

The `package.json` file currently contains:
- `"test": "NODE_OPTIONS=--experimental-vm-modules jest --passWithNoTests"`
- `"test:watch": "NODE_OPTIONS=--experimental-vm-modules jest --watch"`
- `"test:coverage": "NODE_OPTIONS=--experimental-vm-modules jest --coverage --passWithNoTests"`

These scripts exist but may need verification that they work correctly. The project uses ESM modules, which requires the `--experimental-vm-modules` flag.

**Important**: This is the first task in Phase 0 and must be completed before any other testing tasks.

## Checklist

### Preparation and Setup

- [ ] Review `package.json` to understand current test script configuration
- [ ] Understand Jest configuration in `jest.config.js`
- [ ] Verify Node.js version compatibility (requires >=18.0.0)
- [ ] Check if `node_modules` are installed (`npm install` if needed)

### Implementation Steps

- [ ] Step 1: Verify existing test scripts
  - [ ] Open `package.json` and locate the `scripts` section
  - [ ] Confirm `test` script exists and uses Jest
  - [ ] Confirm `test:watch` script exists for watch mode
  - [ ] Confirm `test:coverage` script exists for coverage reports
  - [ ] Verify scripts use correct Jest flags for ESM support
- [ ] Step 2: Add missing scripts if needed
  - [ ] If `test` is missing, add: `"test": "NODE_OPTIONS=--experimental-vm-modules jest --passWithNoTests"`
  - [ ] If `test:watch` is missing, add: `"test:watch": "NODE_OPTIONS=--experimental-vm-modules jest --watch"`
  - [ ] If `test:coverage` is missing, add: `"test:coverage": "NODE_OPTIONS=--experimental-vm-modules jest --coverage --passWithNoTests"`
- [ ] Step 3: Verify scripts work
  - [ ] Run `npm test` to ensure the test suite executes
  - [ ] Confirm tests pass (or at least run without errors)
  - [ ] Verify no syntax errors in test scripts

### Specific Requirements

- [ ] Requirement 1: All three test scripts must exist in `package.json`
  - Acceptance: `npm test`, `npm run test:watch`, and `npm run test:coverage` all execute without errors
- [ ] Requirement 2: Scripts must support ESM modules
  - Acceptance: Scripts include `NODE_OPTIONS=--experimental-vm-modules` flag
- [ ] Requirement 3: Test suite must run successfully
  - Acceptance: `npm test` completes with exit code 0 (even if no tests exist yet)

### Error Handling and Edge Cases

- [ ] Handle case where `package.json` doesn't have a `scripts` section
- [ ] Handle case where Jest is not installed as a dependency
- [ ] Handle case where Node.js version is incompatible
- [ ] Verify scripts work on both Unix and Windows systems (if applicable)

### Testing

- [ ] Run `npm test` and verify it executes without errors
- [ ] Run `npm run test:watch` and verify watch mode starts (can be cancelled immediately)
- [ ] Run `npm run test:coverage` and verify coverage report is generated
- [ ] Verify all scripts return appropriate exit codes
- [ ] **DO NOT manually test by running the server** - use automated verification of scripts only

### Documentation

- [ ] Document any changes made to `package.json` in commit message
- [ ] Note any special configuration requirements (ESM support, etc.)

### Verification

- [ ] Verify all test scripts are present and functional
- [ ] Verify scripts work with current Jest configuration
- [ ] Verify no breaking changes were introduced
- [ ] Confirm scripts follow project conventions

## Notes

- This task is part of **Phase 0 â€“ Baseline & Tooling**
- **Execution Timing**: Must be completed first, before any other testing tasks
- **Dependencies**: None (this is the first task)
- **Important Considerations**: 
  - The project uses ESM modules, requiring special Jest configuration
  - The `--passWithNoTests` flag allows tests to pass even when no test files exist
  - All scripts must include `NODE_OPTIONS=--experimental-vm-modules` for ESM support
- **Task Independence**: Can be completed independently
- **Current State**: Test scripts already exist but need verification

## Related Tasks

- Previous: None (first task)
- Next: TASK-002 (Create/verify logical Jest script groups)
- Dependencies: None
- Related:
  - TASK-002: Will build upon this task by adding test script groups
  - TASK-003: Will verify test setup configuration

## Definition of Done

### Task Type: CONFIGURATION TASK

**Description**: This task involves verifying and potentially configuring test scripts in `package.json`.

**Definition of Done**: "All test scripts are verified to exist and function correctly. If any scripts were missing, they have been added. The `npm test` command executes successfully. All changes have been committed to git and pushed to origin."

### User Stories

1. **As a developer**, I want to run tests using `npm test` so that I can verify code changes.
   - **Acceptance Criteria**: 
     - `npm test` command exists and executes
     - Command completes with exit code 0
     - Tests run (even if no tests exist yet)

2. **As a developer**, I want to run tests in watch mode so that I can see results as I code.
   - **Acceptance Criteria**:
     - `npm run test:watch` command exists and executes
     - Watch mode starts successfully

3. **As a developer**, I want to generate test coverage reports so that I can measure test quality.
   - **Acceptance Criteria**:
     - `npm run test:coverage` command exists and executes
     - Coverage report is generated in `coverage/` directory

### Automated Tests

**Note**: This is a configuration task, so automated tests are not required. However, the following verification steps must be completed:

- [ ] Manual verification: `npm test` executes successfully
- [ ] Manual verification: `npm run test:watch` starts watch mode
- [ ] Manual verification: `npm run test:coverage` generates coverage report

### Git Commit and Push Requirements

- [ ] All changes to `package.json` (if any) are committed to git
- [ ] Commit message follows project conventions (e.g., "test: verify test scripts in package.json")
- [ ] Changes are pushed to origin
- [ ] Commit includes only changes related to this task

### Final Checklist

- [ ] All test scripts verified or added
- [ ] `npm test` executes successfully
- [ ] All changes committed to git
- [ ] Code pushed to origin
- [ ] Task marked as complete
