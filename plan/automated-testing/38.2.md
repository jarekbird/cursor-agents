# TASK-038.2: Test Bull Board base path - dashboard accessibility

**Section**: 5. HTTP/API Black-box Tests (App)
**Subsection**: 5.1.2
**Task ID**: TASK-038.2

## Description

Add a test case to verify that Bull Board dashboard is accessible at the configured base path. The test should verify that a GET request to the dashboard path returns 200 with HTML content.

**Reference Implementation**: 
- `virtual-assistant/cursor-agents/src/app.ts` - Bull Board setup with base path
- `virtual-assistant/cursor-agents/tests/app.test.ts` - existing test structure

## Current State

The `CursorAgentsApp` class:
- Mounts Bull Board dashboard at `/admin/queues` (or configured path)
- Dashboard should be accessible via GET request

The test file `tests/app.test.ts` exists with previous tests including TASK-038.1.

**Important**: This task should be executed after TASK-038.1, completing TASK-038.

## Checklist

### Preparation and Setup

- [ ] Review Bull Board dashboard mounting
- [ ] Understand dashboard path configuration
- [ ] Review test setup from TASK-038.1

### Implementation Steps

- [ ] Step 1: Write test for dashboard accessibility
  - [ ] Create test: `it('should serve Bull Board dashboard at configured base path', async () => { ... })`
  - [ ] Arrange: 
    - [ ] Set `process.env.BULL_BOARD_BASE_PATH = '/agents/admin/queues'`
    - [ ] Create app instance
  - [ ] Act: Make GET request to `/admin/queues` (or configured path)
  - [ ] Assert: 
    - [ ] Response status is 200
    - [ ] Response contains HTML (Bull Board dashboard)

### Specific Requirements

- [ ] Requirement 1: Test must verify dashboard accessibility
  - Acceptance: Dashboard is accessible at configured path
- [ ] Requirement 2: Test must verify response content
  - Acceptance: Response contains HTML content

### Error Handling and Edge Cases

- [ ] Test with various base path values
- [ ] Verify base path is applied correctly

### Testing

- [ ] Run `npm run test:http` to verify all tests execute
- [ ] Verify all test cases pass
- [ ] Verify existing tests still pass
- [ ] Run full test suite to ensure no regressions
- [ ] **DO NOT manually test by running the server** - use automated tests only

### Documentation

- [ ] Add comments explaining dashboard accessibility
- [ ] Note Bull Board setup behavior

### Verification

- [ ] Verify all test cases pass consistently
- [ ] Verify dashboard accessibility works
- [ ] Confirm tests follow project conventions

## Notes

- This task is part of **Phase 5 â€“ HTTP/API Black-box Tests (App)**
- **Execution Timing**: Should be executed after TASK-038.1 (completes TASK-038)
- **Dependencies**: 
  - TASK-038.1: Test Bull Board base path - configuration
- **Important Considerations**: 
  - Dashboard HTML response indicates successful mounting
  - This is the second and final subtask for TASK-038
- **Task Independence**: Can be completed independently after TASK-038.1
- **Current State**: Test file exists with previous tests

## Related Tasks

- Parent: TASK-038 (Extend app.test.ts for Bull Board base path)
- Previous: TASK-038.1 (Test Bull Board base path - configuration)
- Next: TASK-039 (Add tests for /admin/queues/refresh)
- Dependencies:
  - TASK-038.1: Test Bull Board base path - configuration
- Related:
  - TASK-038.1: Other subtask

## Definition of Done

### Task Type: TESTING TASK

**Description**: This task involves writing a test case for Bull Board dashboard accessibility.

**Definition of Done**: "A test case is written that verifies Bull Board dashboard is accessible at the configured base path and returns HTML content. The test passes consistently. All changes have been committed to git and pushed to origin."

### User Stories

1. **As a developer**, I want to verify dashboard accessibility works so that Bull Board can be accessed.
   - **Acceptance Criteria**: 
     - Test verifies dashboard is accessible
     - Test verifies HTML content is returned
     - Test passes consistently

### Automated Tests

The test case should be:

```typescript
describe('Bull Board base path', () => {
  it('should serve Bull Board dashboard at configured base path', async () => {
    // Arrange: Set base path, create app
    process.env.BULL_BOARD_BASE_PATH = '/agents/admin/queues';
    const app = new CursorAgentsApp();
    
    // Act
    const response = await request(app.getApp())
      .get('/admin/queues')
      .expect(200);
    
    // Assert
    expect(response.text).toContain('Bull Board'); // HTML contains dashboard
  });
});
```

- [ ] Test case written and passes
- [ ] Tests verify dashboard accessibility

### Git Commit and Push Requirements

- [ ] Test case added to `tests/app.test.ts`
- [ ] Commit message follows project conventions (e.g., "test: add Bull Board dashboard accessibility test")
- [ ] Changes are pushed to origin
- [ ] Commit includes only this test case

### Final Checklist

- [ ] Test case written and passes
- [ ] Tests verify dashboard accessibility
- [ ] All changes committed to git
- [ ] Code pushed to origin
- [ ] Task marked as complete
- [ ] **TASK-038 (all subtasks) is complete**

